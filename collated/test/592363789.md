# 592363789
###### \java\seedu\address\logic\commands\EditCommandTest.java
``` java
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;
import static org.mockito.Mockito.mock;
import static seedu.address.logic.commands.CommandTestUtil.assertCommandFailure;
import static seedu.address.logic.commands.CommandTestUtil.assertCommandSuccess;
import static seedu.address.logic.commands.CommandTestUtil.prepareUndoCommand;
import static seedu.address.logic.commands.CommandTestUtil.showBookAtIndex;
import static seedu.address.testutil.TypicalBooks.getTypicalBookShelf;
import static seedu.address.testutil.TypicalIndexes.INDEX_FIRST_BOOK;
import static seedu.address.testutil.TypicalIndexes.INDEX_SECOND_BOOK;

import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

import seedu.address.commons.core.Messages;
import seedu.address.commons.core.index.Index;
import seedu.address.logic.CommandHistory;
import seedu.address.logic.UndoStack;
import seedu.address.logic.commands.EditCommand.EditDescriptor;
import seedu.address.model.ActiveListType;
import seedu.address.model.BookShelf;
import seedu.address.model.Model;
import seedu.address.model.ModelManager;
import seedu.address.model.UserPrefs;
import seedu.address.model.book.Book;
import seedu.address.model.book.Priority;
import seedu.address.model.book.Rating;
import seedu.address.model.book.Status;
import seedu.address.network.NetworkManager;
import seedu.address.testutil.BookBuilder;
import seedu.address.testutil.EditDescriptorBuilder;

/**
 * Contains integration tests (interaction with the Model) and unit tests for EditCommand.
 */
```
###### \java\seedu\address\logic\commands\EditCommandTest.java
``` java
    @Test
    public void execute_invalidBookIndexUnfilteredList_failure() {
        Index outOfBoundIndex = Index.fromOneBased(model.getDisplayBookList().size() + 1);
        EditDescriptor descriptor = new EditDescriptorBuilder().withStatus(Status.DEFAULT_STATUS).build();
        EditCommand editCommand = prepareCommand(outOfBoundIndex, descriptor);

        assertCommandFailure(editCommand, model, Messages.MESSAGE_INVALID_BOOK_DISPLAYED_INDEX);
    }

    /**
     * Test with index larger than size of filtered list
     * but smaller than size of book shelf.
     */
    @Test
    public void execute_invalidBookIndexFilteredList_failure() {
        showBookAtIndex(model, INDEX_FIRST_BOOK);
        Index outOfBoundIndex = INDEX_SECOND_BOOK;
        // ensures that outOfBoundIndex is still in bounds of book shelf
        assertTrue(outOfBoundIndex.getZeroBased() < model.getBookShelf().getBookList().size());

        EditDescriptor descriptor = new EditDescriptorBuilder().withStatus(Status.DEFAULT_STATUS).build();
        EditCommand editCommand = prepareCommand(outOfBoundIndex, descriptor);

        assertCommandFailure(editCommand, model, Messages.MESSAGE_INVALID_BOOK_DISPLAYED_INDEX);
    }

    @Test
    public void equals() {
        EditDescriptor descriptor = new EditDescriptorBuilder().withStatus(Status.DEFAULT_STATUS).build();

        EditCommand editCommand = prepareCommand(INDEX_FIRST_BOOK, descriptor);

        // same values -> returns true
        EditCommand commandWithSameValues = prepareCommand(INDEX_FIRST_BOOK, new EditDescriptor(descriptor));
        assertTrue(editCommand.equals(commandWithSameValues));

        // same object -> returns true
        assertTrue(editCommand.equals(editCommand));

        // null -> returns false
        assertFalse(editCommand.equals(null));

        // different types -> returns false
        assertFalse(editCommand.equals(new ClearCommand()));

        // different index -> returns false
        assertFalse(editCommand.equals(new EditCommand(INDEX_SECOND_BOOK, descriptor)));

        // different descriptor -> returns false
        assertFalse(editCommand.equals(new EditCommand(INDEX_FIRST_BOOK,
                new EditDescriptorBuilder().withRating(new Rating(5)).build())));
    }

    /**
     * Returns an {@code EditCommand} with parameters {@code index} and {@code descriptor}.
     */
    private EditCommand prepareCommand(Index index, EditDescriptor descriptor) {
        EditCommand editCommand = new EditCommand(index, descriptor);
        editCommand.setData(model, mock(NetworkManager.class), new CommandHistory(), new UndoStack());
        return editCommand;
    }
}
```
###### \java\seedu\address\logic\commands\LockCommandTest.java
``` java
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;
import static org.mockito.Mockito.mock;
import static seedu.address.testutil.TypicalBooks.getTypicalBookShelf;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import seedu.address.logic.CommandHistory;
import seedu.address.logic.LockManager;
import seedu.address.logic.UndoStack;
import seedu.address.model.Model;
import seedu.address.model.ModelManager;
import seedu.address.model.UserPrefs;
import seedu.address.network.Network;

public class LockCommandTest {

    private Model model;

    @Before
    public void setUp() {
        model = new ModelManager(getTypicalBookShelf(), new UserPrefs());
    }

    @After
    public void tearDown() {
        LockManager.getInstance().unlock(LockManager.getInstance().getPassword());
    }

    @Test
    public void equals() {
        LockCommand lockCommand = new LockCommand();

        // same object -> returns true
        assertTrue(lockCommand.equals(lockCommand));

        // null -> returns false
        assertFalse(lockCommand.equals(null));

        // different commandtypes -> returns false
        assertFalse(lockCommand.equals(new ClearCommand()));

        // different types -> return false
        assertFalse(lockCommand.equals(0));
    }

    @Test
    public void execute_success() {
        LockCommand lockCommand = new LockCommand();
        lockCommand.setData(model, mock(Network.class), new CommandHistory(), new UndoStack());
        CommandResult result = lockCommand.execute();
        assertEquals(LockCommand.MESSAGE_SUCCESS, result.feedbackToUser);
        assertTrue(LockManager.getInstance().isLocked());
    }
}
```
###### \java\seedu\address\logic\commands\SetPasswordCommandTest.java
``` java
public class SetPasswordCommandTest {

    @Rule
    public ExpectedException thrown = ExpectedException.none();

    private Model model;

    @Before
    public void setUp() {
        model = new ModelManager(getTypicalBookShelf(), new UserPrefs());
        LockManager.getInstance().setPassword(LockManager.NO_PASSWORD, "testing");
    }

    @After
    public void tearDown() {
        LockManager.getInstance().initialize(LockManager.NO_PASSWORD);
    }

    @Test
    public void constructor_nullOldPw_throwsNullPointerException() {
        thrown.expect(NullPointerException.class);
        new SetPasswordCommand(null, " ");
    }

    @Test
    public void constructor_nullNewPw_throwsNullPointerException() {
        thrown.expect(NullPointerException.class);
        new SetPasswordCommand(" ", null);
    }

    @Test
    public void execute_correctPw_success() {
        SetPasswordCommand command = prepareCommand("testing", "hello");
        CommandResult result = command.execute();
        assertEquals(SetPasswordCommand.MESSAGE_SUCCESS, result.feedbackToUser);
    }

    @Test
    public void execute_wrongPw_failure() {
        SetPasswordCommand command = prepareCommand("wrongpw", "hello");
        CommandResult result = command.execute();
        assertEquals(SetPasswordCommand.MESSAGE_WRONG_PASSWORD, result.feedbackToUser);
    }

    @Test
    public void equals() {
        SetPasswordCommand setPasswordCommand = new SetPasswordCommand("testing", "newkey");

        SetPasswordCommand thesameCommand = new SetPasswordCommand("testing", "newkey");

        // same value -> returns true
        assertTrue(setPasswordCommand.equals(thesameCommand));

        // same object -> returns true
        assertTrue(setPasswordCommand.equals(setPasswordCommand));

        // null -> returns false
        assertFalse(setPasswordCommand.equals(null));

        // different commandtypes -> returns false
        assertFalse(setPasswordCommand.equals(new ClearCommand()));

        // different types -> return false
        assertFalse(setPasswordCommand.equals(0));
    }

    /**
     * Returns an {@code SetPasswordCommand} with the parameter {@code oldPw} and {@code newPw}.
     */
    private SetPasswordCommand prepareCommand(String oldPw, String newPw) {
        SetPasswordCommand setPasswordCommand = new SetPasswordCommand(oldPw, newPw);
        setPasswordCommand.setData(model, mock(NetworkManager.class), new CommandHistory(), new UndoStack());
        return setPasswordCommand;
    }

}
```
###### \java\seedu\address\logic\commands\UnlockCommandTest.java
``` java
public class UnlockCommandTest {

    private Model model;

    @Before
    public void setUp() {
        model = new ModelManager(getTypicalBookShelf(), new UserPrefs());
        // set password + lock
        LockManager.getInstance().initialize(LockManager.NO_PASSWORD);
        LockManager.getInstance().setPassword(LockManager.NO_PASSWORD, "testing");
        LockManager.getInstance().lock();
    }

    @After
    public void tearDown() {
        LockManager.getInstance().initialize(LockManager.NO_PASSWORD);
    }

    @Test
    public void equals() {

        UnlockCommand unlockCommand = new UnlockCommand("testing");

        UnlockCommand thesameCommand = new UnlockCommand("testing");

        // same value -> returns true
        assertTrue(unlockCommand.equals(thesameCommand));

        // same object -> returns true
        assertTrue(unlockCommand.equals(unlockCommand));

        // null -> returns false
        assertFalse(unlockCommand.equals(null));

        // different commandtypes -> returns false
        assertFalse(unlockCommand.equals(new ClearCommand()));

        // different types -> return false
        assertFalse(unlockCommand.equals(0));

    }

    @Test
    public void sameKeyTest() {
        UnlockCommand unlock = new UnlockCommand("testing");
        unlock.setData(model, mock(Network.class), new CommandHistory(), new UndoStack());
        CommandResult commandResult = unlock.execute();

        assertEquals(UnlockCommand.MESSAGE_SUCCESS, commandResult.feedbackToUser);
    }

    @Test
    public void differentKeyTest() {
        UnlockCommand unlock = new UnlockCommand("test");
        unlock.setData(model, mock(Network.class), new CommandHistory(), new UndoStack());
        CommandResult commandResult = unlock.execute();

        assertEquals(UnlockCommand.MESSAGE_WRONG_PASSWORD, commandResult.feedbackToUser);
    }

}
```
###### \java\seedu\address\logic\parser\EditCommandParserTest.java
``` java
public class EditCommandParserTest {
    private static final int EMPTY_RATING = -1;
    private static final int NON_EMPTY_RATING = 5;
    private static final String STATUS_UNREAD = "u";
    private static final String PRIORITY_HIGH = "high";

    private EditCommandParser parser = new EditCommandParser();

    @Test
    public void parse_indexSpecified_success() {
        // edit status
        Index targetIndex = INDEX_FIRST_BOOK;
        String userInput = targetIndex.getOneBased() + " " + PREFIX_STATUS + STATUS_UNREAD;
        EditCommand expectedCommand = new EditCommand(INDEX_FIRST_BOOK,
                new EditDescriptorBuilder().withStatus(Status.UNREAD).build());
        assertParseSuccess(parser, userInput, expectedCommand);

        // edit priority
        userInput = targetIndex.getOneBased() + " " + PREFIX_PRIORITY + PRIORITY_HIGH;
        expectedCommand = new EditCommand(INDEX_FIRST_BOOK,
                new EditDescriptorBuilder().withPriority(Priority.HIGH).build());
        assertParseSuccess(parser, userInput, expectedCommand);

        // edit rating
        userInput = targetIndex.getOneBased() + " " + PREFIX_RATING + NON_EMPTY_RATING;
        expectedCommand = new EditCommand(INDEX_FIRST_BOOK,
                new EditDescriptorBuilder().withRating(new Rating(NON_EMPTY_RATING)).build());
        assertParseSuccess(parser, userInput, expectedCommand);

        // delete rating
        userInput = targetIndex.getOneBased() + " " + PREFIX_RATING + EMPTY_RATING;
        expectedCommand = new EditCommand(INDEX_FIRST_BOOK,
                new EditDescriptorBuilder().withRating(new Rating(EMPTY_RATING)).build());
        assertParseSuccess(parser, userInput, expectedCommand);
    }

    @Test
    public void parse_missingCompulsoryField_failure() {
        String expectedMessage = String.format(MESSAGE_INVALID_COMMAND_FORMAT, EditCommand.MESSAGE_USAGE);

        // no parameters
        assertParseFailure(parser, EditCommand.COMMAND_WORD + " 1", expectedMessage);

        // no parameters
        assertParseFailure(parser, EditCommand.COMMAND_WORD, expectedMessage);

        // no index
        assertParseFailure(parser, EditCommand.COMMAND_WORD + " " + NON_EMPTY_RATING + " "
                + Priority.DEFAULT_PRIORITY + " " + Status.DEFAULT_STATUS, expectedMessage);
    }
}
```
###### \java\seedu\address\logic\parser\SetPasswordCommandParserTest.java
``` java
public class SetPasswordCommandParserTest {

    private SetPasswordCommandParser parser = new SetPasswordCommandParser();

    @Test
    public void parse_missingCompulsoryField_failure() {

        String expectedinvalidMessage = String.format(MESSAGE_INVALID_COMMAND_FORMAT, SetPasswordCommand.MESSAGE_USAGE);

        // no parameters
        assertParseFailure(parser, "", expectedinvalidMessage);

        // no one of the key
        assertParseFailure(parser, " ", expectedinvalidMessage);

    }

    @Test
    public void parse_validCompulsoryField_success() {
        assertParseSuccess(parser, SetPasswordCommand.COMMAND_WORD + " " + PREFIX_OLD + " " + "oldkey"
                        + " " + PREFIX_NEW + " " + "newkey",
                new SetPasswordCommand("oldkey", "newkey"));
        // no one of the key
        assertParseSuccess(parser, SetPasswordCommand.COMMAND_WORD + " " + PREFIX_NEW + "newkey",
                new SetPasswordCommand("", "newkey"));
    }

}
```
###### \java\seedu\address\model\book\RatingTest.java
``` java
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import org.junit.Test;

import seedu.address.testutil.Assert;

public class RatingTest {

    @Test
    public void constructor_validRating_success() {
        assertEquals(-1, new Rating(-1).rating);
        assertEquals(5, new Rating(5).rating);
    }

    @Test
    public void constructor_invalidRating_throwsIllegalArgumentException() {
        Assert.assertThrows(IllegalArgumentException.class, () -> new Rating(-2));
        Assert.assertThrows(IllegalArgumentException.class, () -> new Rating(6));
    }

    @Test
    public void hashCode_sameContent_returnsSameValue() {
        assertEquals(new Rating(-1).hashCode(), new Rating(-1).hashCode());
        assertEquals(new Rating(0).hashCode(), new Rating(0).hashCode());
    }

    @Test
    public void isValidRating() {
        assertTrue(Rating.isValidRating(-1));
        assertTrue(Rating.isValidRating(5));
        assertFalse(Rating.isValidRating(-2));
        assertFalse(Rating.isValidRating(6));
    }
}
```
###### \java\systemtests\EditCommandSystemTest.java
``` java
import static org.junit.Assert.assertTrue;
import static seedu.address.logic.parser.CliSyntax.PREFIX_PRIORITY;
import static seedu.address.logic.parser.CliSyntax.PREFIX_RATING;
import static seedu.address.logic.parser.CliSyntax.PREFIX_STATUS;
import static seedu.address.testutil.TypicalIndexes.INDEX_FIRST_BOOK;

import org.junit.Test;

import seedu.address.commons.core.Messages;
import seedu.address.commons.core.index.Index;
import seedu.address.logic.commands.EditCommand;
import seedu.address.logic.commands.ListCommand;
import seedu.address.logic.commands.SelectCommand;
import seedu.address.model.Model;
import seedu.address.model.ModelManager;
import seedu.address.model.UserPrefs;
import seedu.address.model.book.Book;
import seedu.address.model.book.Priority;
import seedu.address.model.book.Status;
import seedu.address.testutil.BookBuilder;

public class EditCommandSystemTest extends BibliotekSystemTest {

    @Test
    public void edit() throws Exception {

        /* ----------------- Performing edit operation while an unfiltered list is being shown ---------------------- */

        /* Case: edit all fields -> edited */
        Index index = INDEX_FIRST_BOOK;
        String command = " " + EditCommand.COMMAND_WORD + "  " + index.getOneBased() + "  " + PREFIX_STATUS + "u  "
                + PREFIX_PRIORITY + "high " + PREFIX_RATING + "4  ";
        Book editedBook = new BookBuilder(getModel().getDisplayBookList().get(0)).withStatus(Status.UNREAD)
                .withPriority(Priority.HIGH).withRating(4).build();
        assertCommandSuccess(command, index, editedBook);

        /* Case: edit a book with new values same as existing values -> edited */
        Book bookToEdit = getModel().getDisplayBookList().get(0);
        command = EditCommand.COMMAND_WORD + " " + index.getOneBased() + " " + PREFIX_STATUS
                + bookToEdit.getStatus().toString() + " " + PREFIX_PRIORITY + bookToEdit.getPriority().toString()
                + " " + PREFIX_RATING + bookToEdit.getRating().toString();
        assertCommandSuccess(command, index, new BookBuilder(bookToEdit).build());

        /* Case: edit some fields -> edited */
        command = EditCommand.COMMAND_WORD + " " + index.getOneBased() + " " + PREFIX_STATUS + "r";
        bookToEdit = getModel().getDisplayBookList().get(index.getZeroBased());
        editedBook = new BookBuilder(bookToEdit).withStatus(Status.READ).build();
        assertCommandSuccess(command, index, editedBook);

        /* Case: un-rate book -> unrated */
        index = Index.fromOneBased(getModel().getDisplayBookList().size());
        bookToEdit = getModel().getDisplayBookList().get(index.getZeroBased());
        command = EditCommand.COMMAND_WORD + " " + index.getOneBased() + " " + PREFIX_RATING + "-1";
        editedBook = new BookBuilder(bookToEdit).withRating(-1).build();
        assertCommandSuccess(command, index, editedBook);

        /* ------------------ Performing edit operation while a filtered list is being shown ------------------------ */

        /* Case: filtered book list, edit index within bounds of book shelf and book list -> edited */
        executeCommand(ListCommand.COMMAND_WORD + " " + PREFIX_STATUS + "u");
        index = INDEX_FIRST_BOOK;
        assertTrue(index.getZeroBased() < getModel().getDisplayBookList().size());
        command = EditCommand.COMMAND_WORD + " " + index.getOneBased() + " " + PREFIX_STATUS + "r";
        bookToEdit = getModel().getDisplayBookList().get(index.getZeroBased());
        editedBook = new BookBuilder(bookToEdit).withStatus(Status.READ).build();
        assertCommandSuccess(command, index, editedBook);

        /* Case: edit index within bounds of book shelf but out of bounds of filtered book list -> rejected */
        executeCommand(ListCommand.COMMAND_WORD + " " + PREFIX_STATUS + "u");
        int invalidIndex = getModel().getDisplayBookList().size() + 1;
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + invalidIndex + " " + PREFIX_RATING + "2",
                Messages.MESSAGE_INVALID_BOOK_DISPLAYED_INDEX);

        /* --------------------- Performing edit operation while a book card is selected -------------------------- */

        /* Case: selects first card in the book list, edit a book -> edited, card selection remains unchanged */
        executeCommand(ListCommand.COMMAND_WORD);
        index = INDEX_FIRST_BOOK;
        executeCommand(SelectCommand.COMMAND_WORD + " " + index.getOneBased());
        command = EditCommand.COMMAND_WORD + " " + index.getOneBased() + " " + PREFIX_RATING + "5";
        bookToEdit = getModel().getDisplayBookList().get(index.getZeroBased());
        editedBook = new BookBuilder(bookToEdit).withRating(5).build();
        Model expectedModel = getModel();
        expectedModel.updateBook(bookToEdit, editedBook);
        assertCommandSuccess(command, editedBook, expectedModel);

        /* --------------------------------- Performing invalid edit operation -------------------------------------- */


        /* Case: invalid index (0) -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " 0 " + PREFIX_RATING + "5",
                String.format(Messages.MESSAGE_INVALID_COMMAND_FORMAT, EditCommand.MESSAGE_USAGE));

        /* Case: invalid index (-1) -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " -1 " + PREFIX_RATING + "5",
                String.format(Messages.MESSAGE_INVALID_COMMAND_FORMAT, EditCommand.MESSAGE_USAGE));

        /* Case: invalid index (size + 1) -> rejected */
        invalidIndex = getModel().getDisplayBookList().size() + 1;
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + invalidIndex + " " + PREFIX_RATING + "5",
                Messages.MESSAGE_INVALID_BOOK_DISPLAYED_INDEX);

        /* Case: missing index -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + PREFIX_RATING + "5",
                String.format(Messages.MESSAGE_INVALID_COMMAND_FORMAT, EditCommand.MESSAGE_USAGE));

        /* Case: missing all fields -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + INDEX_FIRST_BOOK.getOneBased(),
                EditCommand.MESSAGE_NO_PARAMETERS);

        /* Case: invalid status -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + INDEX_FIRST_BOOK.getOneBased() + " "
                + PREFIX_STATUS + "status", Messages.MESSAGE_INVALID_STATUS);

        /* Case: invalid priority -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + INDEX_FIRST_BOOK.getOneBased() + " "
                + PREFIX_PRIORITY + "priority", Messages.MESSAGE_INVALID_PRIORITY);

        /* Case: invalid rating -> rejected */
        assertCommandFailure(EditCommand.COMMAND_WORD + " " + INDEX_FIRST_BOOK.getOneBased() + " "
                + PREFIX_RATING + "100", Messages.MESSAGE_INVALID_RATING);
    }
```
